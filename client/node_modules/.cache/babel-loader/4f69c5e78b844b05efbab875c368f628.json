{"ast":null,"code":"import _slicedToArray from \"/Users/lukas/Documents/GitHub/spotify-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/lukas/Documents/GitHub/spotify-app/client/src/pages/explore/index.tsx\";\nimport React, { useState } from \"react\";\nimport { updateStorageData, getStorageData } from \"../../utilities/localStorage\";\nimport { GET_TRACKS_QUERY } from \"../../graphqlQueries\";\nimport { QueryError } from \"../../components/queryError\";\nimport { Query } from \"react-apollo\";\nimport { SwipeCard } from \"./swipeCard\";\nimport { CardBody } from \"../../components/cardBody\";\nimport { Button } from \"../../components/button\";\nimport { Alert } from \"../../components/alert\";\nimport { Spinner } from \"../../components/spinner\";\nimport \"../../Shared.css\";\nimport \"./Dashboard.css\";\n\nconst Dashboard = props => {\n  const _useState = useState(0),\n        _useState2 = _slicedToArray(_useState, 2),\n        currentIndex = _useState2[0],\n        updateIndex = _useState2[1];\n\n  const _useState3 = useState(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        isSongSaved = _useState4[0],\n        setIsSongSaved = _useState4[1];\n\n  const _useState5 = useState(false),\n        _useState6 = _slicedToArray(_useState5, 2),\n        isError = _useState6[0],\n        setIsError = _useState6[1];\n\n  const nextSong = () => {\n    updateIndex(currentIndex + 1);\n    const audioBar = document.querySelector(\".card__audio-bar\");\n    if (audioBar) audioBar.load();\n  };\n\n  const previousSong = () => {\n    updateIndex(currentIndex - 1);\n    const audioBar = document.querySelector(\".card__audio-bar\");\n    if (audioBar) audioBar.load();\n  };\n\n  const saveSong = id => {\n    const savedTracks = getStorageData(\"saved_tracks\");\n\n    if (savedTracks && savedTracks.includes(id)) {\n      setIsError(true);\n      setTimeout(function () {\n        setIsError(false);\n      }, 2000);\n      return;\n    }\n\n    const result = updateStorageData(\"saved_tracks\", id);\n\n    if (result) {\n      setIsSongSaved(true);\n      setTimeout(function () {\n        setIsSongSaved(false);\n      }, 2000);\n    }\n  };\n\n  const displayGenres = () => {\n    const genres = getStorageData(\"selected_genres\");\n    return genres.reduce((acc, value, index, arr) => {\n      if (index === arr.length - 1) return acc.concat(value);\n      return acc.concat(\"\".concat(value, \", \"));\n    }, \"\");\n  };\n\n  return React.createElement(\"div\", {\n    className: \"d-flex justify-content-center align-items-center h-100\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }, isSongSaved ? React.createElement(Alert, {\n    message: \"Song was successfuly saved!\",\n    isSuccess: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }) : null, isError ? React.createElement(Alert, {\n    message: \"You already saved this song!\",\n    isSuccess: false,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }) : null, getStorageData(\"selected_genres\") ? React.createElement(Query, {\n    query: GET_TRACKS_QUERY,\n    variables: {\n      selectedGenres: getStorageData(\"selected_genres\")\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, properties => {\n    if (properties.loading) return React.createElement(Spinner, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    });\n\n    if (properties.error) {\n      const error = properties.error.graphQLErrors[0].message;\n      return React.createElement(QueryError, {\n        pushHistory: props.history.push,\n        errorMessage: error,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      });\n    } else {\n      return React.createElement(\"div\", {\n        className: \"content-wrapper d-flex flex-column align-items-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"heading__secondary mb-3 text-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"text-white\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, \"Current Genres:\"), \" \", displayGenres()), React.createElement(SwipeCard, {\n        nextSong: () => nextSong(),\n        previousSong: () => previousSong(),\n        image: properties.data.suggestedTracks[currentIndex].album.images.url,\n        listLength: properties.data.suggestedTracks.length,\n        currentIndex: currentIndex,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }), React.createElement(CardBody, {\n        artists: properties.data.suggestedTracks[currentIndex].artists,\n        name: properties.data.suggestedTracks[currentIndex].name,\n        preview_url: properties.data.suggestedTracks[currentIndex].preview_url,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }), React.createElement(Button, {\n        type: \"primary\",\n        title: \"Add to playlist\",\n        action: () => saveSong(properties.data.suggestedTracks[currentIndex].id),\n        colors: \"bg-primary text-white\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }));\n    }\n  }) : props.history.push({\n    pathname: \"/\",\n    state: {\n      genresError: true\n    }\n  }));\n};\n\nexport default Dashboard;","map":{"version":3,"sources":["/Users/lukas/Documents/GitHub/spotify-app/client/src/pages/explore/index.tsx"],"names":["React","useState","updateStorageData","getStorageData","GET_TRACKS_QUERY","QueryError","Query","SwipeCard","CardBody","Button","Alert","Spinner","Dashboard","props","currentIndex","updateIndex","isSongSaved","setIsSongSaved","isError","setIsError","nextSong","audioBar","document","querySelector","load","previousSong","saveSong","id","savedTracks","includes","setTimeout","result","displayGenres","genres","reduce","acc","value","index","arr","length","concat","selectedGenres","properties","loading","error","graphQLErrors","message","history","push","data","suggestedTracks","album","images","url","artists","name","preview_url","pathname","state","genresError"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,SACIC,iBADJ,EAEIC,cAFJ,QAGO,8BAHP;AAIA,SAASC,gBAAT,QAAiC,sBAAjC;AACA,SAASC,UAAT,QAA2B,6BAA3B;AACA,SAASC,KAAT,QAAsB,cAAtB;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,SAASC,QAAT,QAAyB,2BAAzB;AACA,SAASC,MAAT,QAAuB,yBAAvB;AACA,SAASC,KAAT,QAAsB,wBAAtB;AACA,SAASC,OAAT,QAAwB,0BAAxB;AACA,OAAO,kBAAP;AACA,OAAO,iBAAP;;AAEA,MAAMC,SAAS,GAAIC,KAAD,IAAgB;AAAA,oBACMZ,QAAQ,CAAC,CAAD,CADd;AAAA;AAAA,QACvBa,YADuB;AAAA,QACTC,WADS;;AAAA,qBAEQd,QAAQ,CAAC,KAAD,CAFhB;AAAA;AAAA,QAEvBe,WAFuB;AAAA,QAEVC,cAFU;;AAAA,qBAGAhB,QAAQ,CAAC,KAAD,CAHR;AAAA;AAAA,QAGvBiB,OAHuB;AAAA,QAGdC,UAHc;;AAK9B,QAAMC,QAAQ,GAAG,MAAY;AACzBL,IAAAA,WAAW,CAACD,YAAY,GAAG,CAAhB,CAAX;AACA,UAAMO,QAAQ,GAAGC,QAAQ,CAACC,aAAT,CACb,kBADa,CAAjB;AAGA,QAAIF,QAAJ,EAAcA,QAAQ,CAACG,IAAT;AACjB,GAND;;AAQA,QAAMC,YAAY,GAAG,MAAY;AAC7BV,IAAAA,WAAW,CAACD,YAAY,GAAG,CAAhB,CAAX;AACA,UAAMO,QAAQ,GAAGC,QAAQ,CAACC,aAAT,CACb,kBADa,CAAjB;AAGA,QAAIF,QAAJ,EAAcA,QAAQ,CAACG,IAAT;AACjB,GAND;;AAQA,QAAME,QAAQ,GAAIC,EAAD,IAAsB;AACnC,UAAMC,WAAW,GAAGzB,cAAc,CAAC,cAAD,CAAlC;;AAEA,QAAIyB,WAAW,IAAIA,WAAW,CAACC,QAAZ,CAAqBF,EAArB,CAAnB,EAA6C;AACzCR,MAAAA,UAAU,CAAC,IAAD,CAAV;AACAW,MAAAA,UAAU,CAAC,YAAW;AAClBX,QAAAA,UAAU,CAAC,KAAD,CAAV;AACH,OAFS,EAEP,IAFO,CAAV;AAGA;AACH;;AAED,UAAMY,MAAM,GAAG7B,iBAAiB,CAAC,cAAD,EAAiByB,EAAjB,CAAhC;;AAEA,QAAII,MAAJ,EAAY;AACRd,MAAAA,cAAc,CAAC,IAAD,CAAd;AACAa,MAAAA,UAAU,CAAC,YAAW;AAClBb,QAAAA,cAAc,CAAC,KAAD,CAAd;AACH,OAFS,EAEP,IAFO,CAAV;AAGH;AACJ,GAnBD;;AAqBA,QAAMe,aAAa,GAAG,MAAc;AAChC,UAAMC,MAAM,GAAG9B,cAAc,CAAC,iBAAD,CAA7B;AAEA,WAAO8B,MAAM,CAACC,MAAP,CACH,CAACC,GAAD,EAAgBC,KAAhB,EAA+BC,KAA/B,EAA8CC,GAA9C,KAAgE;AAC5D,UAAID,KAAK,KAAKC,GAAG,CAACC,MAAJ,GAAa,CAA3B,EAA8B,OAAOJ,GAAG,CAACK,MAAJ,CAAWJ,KAAX,CAAP;AAC9B,aAAOD,GAAG,CAACK,MAAJ,WAAcJ,KAAd,QAAP;AACH,KAJE,EAKH,EALG,CAAP;AAOH,GAVD;;AAYA,SACI;AAAK,IAAA,SAAS,EAAC,wDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACKpB,WAAW,GACR,oBAAC,KAAD;AAAO,IAAA,OAAO,EAAE,6BAAhB;AAA+C,IAAA,SAAS,EAAE,IAA1D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADQ,GAER,IAHR,EAIKE,OAAO,GACJ,oBAAC,KAAD;AAAO,IAAA,OAAO,EAAE,8BAAhB;AAAgD,IAAA,SAAS,EAAE,KAA3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADI,GAEJ,IANR,EAQKf,cAAc,CAAC,iBAAD,CAAd,GACG,oBAAC,KAAD;AACI,IAAA,KAAK,EAAEC,gBADX;AAEI,IAAA,SAAS,EAAE;AAAEqC,MAAAA,cAAc,EAAEtC,cAAc,CAAC,iBAAD;AAAhC,KAFf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAIMuC,UAAD,IAAqB;AAClB,QAAIA,UAAU,CAACC,OAAf,EAAwB,OAAO,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;;AACxB,QAAID,UAAU,CAACE,KAAf,EAAsB;AAClB,YAAMA,KAAK,GAAGF,UAAU,CAACE,KAAX,CAAiBC,aAAjB,CAA+B,CAA/B,EAAkCC,OAAhD;AACA,aACI,oBAAC,UAAD;AACI,QAAA,WAAW,EAAEjC,KAAK,CAACkC,OAAN,CAAcC,IAD/B;AAEI,QAAA,YAAY,EAAEJ,KAFlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ;AAMH,KARD,MAQO;AACH,aACI;AAAK,QAAA,SAAS,EAAC,uDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAK,QAAA,SAAS,EAAC,sCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAM,QAAA,SAAS,EAAC,YAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BADJ,EACwD,GADxD,EAEKZ,aAAa,EAFlB,CADJ,EAKI,oBAAC,SAAD;AACI,QAAA,QAAQ,EAAE,MAAMZ,QAAQ,EAD5B;AAEI,QAAA,YAAY,EAAE,MAAMK,YAAY,EAFpC;AAGI,QAAA,KAAK,EACDiB,UAAU,CAACO,IAAX,CAAgBC,eAAhB,CAAgCpC,YAAhC,EAA8CqC,KAA9C,CAAoDC,MAApD,CACKC,GALb;AAOI,QAAA,UAAU,EAAEX,UAAU,CAACO,IAAX,CAAgBC,eAAhB,CAAgCX,MAPhD;AAQI,QAAA,YAAY,EAAEzB,YARlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QALJ,EAgBI,oBAAC,QAAD;AACI,QAAA,OAAO,EACH4B,UAAU,CAACO,IAAX,CAAgBC,eAAhB,CAAgCpC,YAAhC,EAA8CwC,OAFtD;AAII,QAAA,IAAI,EAAEZ,UAAU,CAACO,IAAX,CAAgBC,eAAhB,CAAgCpC,YAAhC,EAA8CyC,IAJxD;AAKI,QAAA,WAAW,EACPb,UAAU,CAACO,IAAX,CAAgBC,eAAhB,CAAgCpC,YAAhC,EAA8C0C,WANtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAhBJ,EAyBI,oBAAC,MAAD;AACI,QAAA,IAAI,EAAE,SADV;AAEI,QAAA,KAAK,EAAE,iBAFX;AAGI,QAAA,MAAM,EAAE,MACJ9B,QAAQ,CAACgB,UAAU,CAACO,IAAX,CAAgBC,eAAhB,CAAgCpC,YAAhC,EAA8Ca,EAA/C,CAJhB;AAMI,QAAA,MAAM,EAAE,uBANZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAzBJ,CADJ;AAoCH;AACJ,GApDL,CADH,GAwDGd,KAAK,CAACkC,OAAN,CAAcC,IAAd,CAAmB;AACfS,IAAAA,QAAQ,EAAE,GADK;AAEfC,IAAAA,KAAK,EAAE;AAAEC,MAAAA,WAAW,EAAE;AAAf;AAFQ,GAAnB,CAhER,CADJ;AAwEH,CA9HD;;AAgIA,eAAe/C,SAAf","sourcesContent":["import React, { useState } from \"react\";\nimport {\n    updateStorageData,\n    getStorageData\n} from \"../../utilities/localStorage\";\nimport { GET_TRACKS_QUERY } from \"../../graphqlQueries\";\nimport { QueryError } from \"../../components/queryError\";\nimport { Query } from \"react-apollo\";\nimport { SwipeCard } from \"./swipeCard\";\nimport { CardBody } from \"../../components/cardBody\";\nimport { Button } from \"../../components/button\";\nimport { Alert } from \"../../components/alert\";\nimport { Spinner } from \"../../components/spinner\";\nimport \"../../Shared.css\";\nimport \"./Dashboard.css\";\n\nconst Dashboard = (props: any) => {\n    const [currentIndex, updateIndex] = useState(0);\n    const [isSongSaved, setIsSongSaved] = useState(false);\n    const [isError, setIsError] = useState(false);\n\n    const nextSong = (): void => {\n        updateIndex(currentIndex + 1);\n        const audioBar = document.querySelector(\n            \".card__audio-bar\"\n        ) as HTMLVideoElement;\n        if (audioBar) audioBar.load();\n    };\n\n    const previousSong = (): void => {\n        updateIndex(currentIndex - 1);\n        const audioBar = document.querySelector(\n            \".card__audio-bar\"\n        ) as HTMLVideoElement;\n        if (audioBar) audioBar.load();\n    };\n\n    const saveSong = (id: string): void => {\n        const savedTracks = getStorageData(\"saved_tracks\");\n\n        if (savedTracks && savedTracks.includes(id)) {\n            setIsError(true);\n            setTimeout(function() {\n                setIsError(false);\n            }, 2000);\n            return;\n        }\n\n        const result = updateStorageData(\"saved_tracks\", id);\n\n        if (result) {\n            setIsSongSaved(true);\n            setTimeout(function() {\n                setIsSongSaved(false);\n            }, 2000);\n        }\n    };\n\n    const displayGenres = (): string => {\n        const genres = getStorageData(\"selected_genres\");\n\n        return genres.reduce(\n            (acc: string[], value: string, index: number, arr: string[]) => {\n                if (index === arr.length - 1) return acc.concat(value);\n                return acc.concat(`${value}, `);\n            },\n            \"\"\n        );\n    };\n\n    return (\n        <div className=\"d-flex justify-content-center align-items-center h-100\">\n            {isSongSaved ? (\n                <Alert message={\"Song was successfuly saved!\"} isSuccess={true} />\n            ) : null}\n            {isError ? (\n                <Alert message={\"You already saved this song!\"} isSuccess={false} />\n            ) : null}\n\n            {getStorageData(\"selected_genres\") ? (\n                <Query\n                    query={GET_TRACKS_QUERY}\n                    variables={{ selectedGenres: getStorageData(\"selected_genres\") }}\n                >\n                    {(properties: any) => {\n                        if (properties.loading) return <Spinner />;\n                        if (properties.error) {\n                            const error = properties.error.graphQLErrors[0].message;\n                            return (\n                                <QueryError\n                                    pushHistory={props.history.push}\n                                    errorMessage={error}\n                                />\n                            );\n                        } else {\n                            return (\n                                <div className=\"content-wrapper d-flex flex-column align-items-center\">\n                                    <div className=\"heading__secondary mb-3 text-primary\">\n                                        <span className=\"text-white\">Current Genres:</span>{\" \"}\n                                        {displayGenres()}\n                                    </div>\n                                    <SwipeCard\n                                        nextSong={() => nextSong()}\n                                        previousSong={() => previousSong()}\n                                        image={\n                                            properties.data.suggestedTracks[currentIndex].album.images\n                                                .url\n                                        }\n                                        listLength={properties.data.suggestedTracks.length}\n                                        currentIndex={currentIndex}\n                                    />\n\n                                    <CardBody\n                                        artists={\n                                            properties.data.suggestedTracks[currentIndex].artists\n                                        }\n                                        name={properties.data.suggestedTracks[currentIndex].name}\n                                        preview_url={\n                                            properties.data.suggestedTracks[currentIndex].preview_url\n                                        }\n                                    />\n                                    <Button\n                                        type={\"primary\"}\n                                        title={\"Add to playlist\"}\n                                        action={() =>\n                                            saveSong(properties.data.suggestedTracks[currentIndex].id)\n                                        }\n                                        colors={\"bg-primary text-white\"}\n                                    />\n                                </div>\n                            );\n                        }\n                    }}\n                </Query>\n            ) : (\n                props.history.push({\n                    pathname: \"/\",\n                    state: { genresError: true }\n                })\n            )}\n        </div>\n    );\n};\n\nexport default Dashboard;\n"]},"metadata":{},"sourceType":"module"}